# coding=utf-8
from gmpy2 import *
from Crypto.Util.number import *
p, q, dmp, dmq, c1, c2, c3, c4 = 12088887485280517146272351590086025512894829636183954778563449580550231370376017554816220328955961172075206459267753929996237621298555579019727394465674063L, 11344223853740693557654410531952195662821090736896673801003676892459775449192551267317101594215180569551903151725246207006028341210716508671503703010092427L, mpz(10032761362528417809390786686983630749882852861617512113543758973557077707894035928506123156110127559375548294496563592927368299484757626525952458340568503L), mpz(4868092267168885038974809401311095920573250902516232858368050006494301884831642892750785770087167286801734022695787726561945151455977178294054408017682577L), 30875403489876653885912547279018806549030905480248397936846247378245217866257457222440730253201998862445121908304324870229231062775227856785108589489716468723769279647110987048414321923856621576438500825110176611429118306067270762875938728994680679031824430158750808640691062408446878763972845493756699928493L, 1042892267355594297120540442368551754479736519333196669066168173894861527888583645029915429895390975939643541002325080677596334842933885095969973479367082602176378286808385571707413736310408401831698246429745043504546544024553352281916164014254561193273162048745382153304092774308783733558427045943861420522L, 13305663883272784424661605146290094046943709696152618284699103777893195792759238135155097653440248019202785016453036037532528697388406129510827220150275169896654638862661849022432212729359296475510022362947180755107281832415074206443768060780664134664521192493999750714278456406689911778065742015535523678936L, 8977734959582960872873572465034715330131594232013324014791049087451625600242275891657172846905069987995860238290582324481257433082768040460319871422977899145905016726462924892566788730774383043248892562204164976344393965963075787162813999301162634347441757624654276169168018637973453997305233254555929739040L
# n: 113061518849140299143395261356124990808826792416052027569942605340212046492278989825137016502962900412531159933420659047167411702784038372551458395315943385841093879901445609344166629884168858196305952675781919693073036360024648017625981955281393571333991955277042492553914191373132779836213070305257306544583
# c: 2339214817367283726506759490423720494013145182897827336760047378449580525910204459167221460175458432884603520847112555781456871445382030469182504935568534402934305271522624944324974244810813120800696935782508204069910404268400581854097937195742955809256445885634138564781876571100279969785138474705072283040

# recover all m
a = 3763150252243497520
b = 4010957094992677435331075205271409029631383199926585555284702027910418399772856566863113042978049812537115807584040680786874811477252533745322397747616098
c = 3690755098720429111

m = long_to_bytes(a) + long_to_bytes(b) + long_to_bytes(c)
m = bytes_to_long(m) << 128
print m
# 316714907915949424038841953926127091332969777737819160399024478601843545979024640380164673746116070832599817185353410273888227806107989548906546323503891802290881197180997706025408261704034731545955681120961277231275367403035295744

# 通过magma已知高比特信息攻击得到相应的低比特信息
m += 76270690659566127897814625642773374519
m = long_to_bytes(m)
flag = 'flag{%s-%s-%s-%s-%s}' % (m[:8], m[72: 76], m[76: 80], m[80:84], m[84:])
print(flag)

# n:=84907002688500858173155378284676816849902919768144158775096078489305961330229646477183266671479429536508393269400286354477393166904647504371571058694938751736253255515130365470333830002027548315838676562037860791418367617520660403470968914558107700705509197788422318487265158299688305396352146906818579523273;
# Fp:=GF(n);
# R<x> := PolynomialRing(Fp);
# c := 42118630804406826829986327836708533005905799018987333321090544874021423407558171991776173024000214726791008294650949843551675847795157802061409331673966163318875158976661655454951556430249046882338524828988191686383216355357997732853436677494118058553116438073892216783322394506559374103250927710537200165128;
# m := 340897678053922777986466486815855791016914313287399627632881642217884659172258326637226681304519024632042712914788141368745298286109241579528814425987029685566158334567079435893037350965388466075165771235400139366856687652423335936;
# f := (x+m)^5 - c;

# ['49e7ee20', '3825', '41d7', '9a3a', '5fec9933c2f7']