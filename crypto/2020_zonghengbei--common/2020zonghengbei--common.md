## 2020_纵横杯--common
## 比赛日期：2020年12月26日

## 题目
有1个python文件``task2.py``和1个数据文件``task2.txt``。
```python
from Crypto.Util.number import *

e1 =  28720970875923431651096339432854172528258265954461865674640550905460254396153781189674547341687577425387833579798322688436040388359600753225864838008717449960738481507237546818409576080342018413998438508242156786918906491731633276138883100372823397583184685654971806498370497526719232024164841910708290088581
e2 =  131021266002802786854388653080729140273443902141665778170604465113620346076511262124829371838724811039714548987535108721308165699613894661841484523537507024099679248417817366537529114819815251239300463529072042548335699747397368129995809673969216724195536938971493436488732311727298655252602350061303755611563
N =  159077408219654697980513139040067154659570696914750036579069691821723381989448459903137588324720148582015228465959976312274055844998506120677137485805781117564072817251103154968492955749973403646311198170703330345340987100788144707482536112028286039187104750378366564167383729662815980782817121382587188922253
flag = b"flag{xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx}"
f1 = bytes_to_long(flag[:21])
f2 = bytes_to_long(flag[21:])
c1 = pow(f1, e1, N)
c2 = pow(f2, e2, N)

print("e1 = ", e1)
print("e2 = ", e2)
print("N = ", N)
print("c1 = ", c1)
print("c2 = ", c2)
```

## 解题

***TODO 未完成***

记 Wiener equations 和 Guo equations 为

$W_i : e_i d_i g − k_i N = g − k_i s$
$G_{i,j} : k_i d_j e_j − k_j d_i e_i = k_i − k_j$

则 $k_1 k_2 = k_1 k_2, k_2 W_1, g G_{1,2}, W_1 W_2$ 转化成矩阵形式, 有 $x B = v$, 其中

$x = (k_1 k_2, k_2 d_1 g, k_1 d_2 g, d_1 d_2 g^2 )$
$$
B = \begin{bmatrix}
1 & −N & 0 & N^2 \\
& e_1 & −e_1 & −e_1 N \\
& & e_2 & −e_2 N \\
& & & e_1 e_2 \\
\end{bmatrix}
$$
$v = ( k_1 k_2, k_2 (g − k_1 s), g(k_1 − k_2 ), (g − k_1 s)(g − k_2 s) ) $

令 $D = diag(N, N^{1/2}, N^{1+δ}, 1)$, 使其满足 Minkowski’s bound, 有 $||vD|| < vol(L) = |\det(B) \det(D)|$
即 $N^{2(1/2+δ)} < 2N^{(13/2+δ)/4}$, $\delta < 5/14 – \epsilon$.

利用 LLL 求出最短向量 $vD$, 进而求出 $x$, 根据 Wiener’s attack,$\varphi(N) = g(ed-1)/k = \lfloor{edg/k}\rfloor$
有了 $\varphi(N)$ 即可构造一元二次方程分解 $N$.